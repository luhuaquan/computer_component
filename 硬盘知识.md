### 机械硬盘

#### 1. 机械硬盘存储数据的工作原理

​	主要结构：马达、磁盘、磁头臂和磁头等，转数通常在5400转/分钟 或 7200转/分钟，通过控制（电）磁铁的状态来改变磁性材料磁化后的磁极，来存储0和1的数据。有LMR和PMR两种类型，其中PMR又分为CMR（传统磁盘）和SMR（瓦叠磁盘）。

​	图1 机械硬盘读数据-水平磁记录 LMR

![image-20240814154144280](C:\Users\H7113084\AppData\Roaming\Typora\typora-user-images\image-20240814154144280.png)

​	图2 机械硬盘读数据-垂直磁记录 PBR（提高了数据密度）

![image-20240814154110217](C:\Users\H7113084\AppData\Roaming\Typora\typora-user-images\image-20240814154110217.png)

#### 2. 瓦叠式磁盘

读写数据：定位扇区位置，就需要寻道和寻址

​	写磁头要比读磁头宽，那么单条磁道的有效宽度将由读磁头宽度决定，但写磁头因技术问题没办法做的更小，不得已浪费掉上下磁道的空间，另外，为了避免相邻磁道间干扰，磁道间也会留些间隙。

![image-20240814160150112](C:\Users\H7113084\AppData\Roaming\Typora\typora-user-images\image-20240814160150112.png)

叠瓦式磁盘的想法：就是在空隙间插入更多的磁道，以此来提高数据密度。

为了解决写磁头太宽导致的磁道浪费和磁道单饶导致的磁道间隙？ 把磁道堆叠起来

![image-20240814160230463](C:\Users\H7113084\AppData\Roaming\Typora\typora-user-images\image-20240814160230463.png)

​	瓦叠磁盘的读写原理：将磁道像瓦片一样堆叠，读数据不影响，改写数据比较繁琐。改写某磁道的数据会影响相邻磁道的数据，需要先搬移，再改写。	瓦叠的最大单位是扇区，最多就影响那一个扇区内所有瓦叠在一起的磁道，而不是整个磁盘。



### 小结：

​	对于1TB的机械硬盘，都不需要使用SMR，单碟CMR就可以做到1TB。2TB以上就要小心了，尤其是缓存大的机械硬盘！



### SSD固态硬盘

![image-20240814154245154](C:\Users\H7113084\AppData\Roaming\Typora\typora-user-images\image-20240814154245154.png)

#### 1. 固态硬盘的种类

消费级固态三种接口形态：PCIE、SATA和M.2。

​	PCIE接口（少）：浦科特 

​	SATA接口：SATA 3.0 （6Gbps）理论上限 600MB/s，实际在550MB/s

​	M.2接口（主流）：

​	M key 防呆缺口在右侧

​		PCIE x4 通道，NVME传输协议（使固态硬盘走PCIE通道而设计的协议）

​		PCIE 3.0 x4 理论速率 4GB/s 旗舰和普通（首选，性价比最高）

​		PCIE 4.0 x4 理论速率 8GB/s（主板要支持PCIE 4.0哦！）

​		注：PCIE4.0向下兼容，若主板支持PCIE4.0，那么也可以使用PCIE3.0的固态。

​	B&M key 两侧都有防呆缺口

​		SATA 通道 550 MB/s （除非主板M.2接口已用完，否则不考虑）







#### 2. 闪存颗粒

![image-20240814112159942](C:\Users\H7113084\AppData\Roaming\Typora\typora-user-images\image-20240814112159942.png)

闪存颗粒在固态硬盘中负责存放数据。

闪存颗粒分四种：

SLC单层单元闪存	MLC多层单元闪存	TLC三层单元闪存	QLC四层单元闪存

闪存颗粒的数据存储方式：用电来存储数据

数据本质是0和1序列组成的

SLC颗粒 每一个存储单元只能存储0或1，即1bit数据。

思考：通过控制电子的数量实现数据容量翻倍。

![image-20240814112233438](C:\Users\H7113084\AppData\Roaming\Typora\typora-user-images\image-20240814112233438.png)

TLC颗粒 每一个存储单元能存储3bit数据...

代价：

① 速度 SLC>MLC>TLC>QLC    SLC结构简单，速度最快（举例理解：带刻度的杯子注水）

② 寿命 SLC>MLC>TLC>QLC    反复擦写对存储单元有磨损，拿寿命换成本和空间。

目前，TLC是主流，QLC在蠢蠢欲动。

颗粒厂家：

三星、海力士、闪迪-西数（闪迪被西数收购）

铠侠（原东芝）、镁光-英睿达（子品牌）、长江存储-致钛（致态）

原厂、白片和黑片

以镁光为例

原材料（石英矿）->高纯度硅 -> 单晶硅棒 -> 单晶硅片（晶圆）-> 光刻机（蚀刻）-> 闪存颗粒（封装前淘汰颗粒）-> 检测通过 -> 封装  封装后淘汰颗粒) -> 检测通过 -> 原厂原封颗粒（原片）

封装前淘汰颗粒：

① 交由子公司（SpecTek）处理，并进行技术屏蔽处理，再卖给其它厂家。（原厂降级片 S标记）

② 直接卖给其它厂家（黑片）

③ 卖给没有生产能力，但有检测封装能力的其它厂家（原厂第三方封测颗粒）

④ 垃圾回收片，其他渠道淘汰的颗粒

#### 3. 主控

固态硬盘的控制系统，决定处理数据的能力和算法等，包括走SATA、PCIE3.0还是PCIE4.0通道都由主控决定。

#### 4. 缓存

分独立缓存（DRAM）和模拟缓存

独立缓存本质就是内存（速度快，并非所有固态都有独立缓存），作用存放FTL映射表（等同于书籍目录）

没有独立缓存的固态，其FTL映射表放在哪里呀？① 缓存颗粒中 ② 电脑内存条 都不如独立缓存。

![image-20240814112313629](C:\Users\H7113084\AppData\Roaming\Typora\typora-user-images\image-20240814112313629.png)

模拟缓存（固态必备）数据中转仓，提升固态的数据处理速度

![image-20240814112347426](C:\Users\H7113084\AppData\Roaming\Typora\typora-user-images\image-20240814112347426.png)

模拟缓存将TLC颗粒中的一部分空间或全部空间都当做SLC来用（当数据占满了再改回TLC来使用）

缺点：当数据占满时，速度下降。可额外提供存储单元来作为缓存，就不会影响缓存速度。

缓内写入速度和缓外写入速度

举例：致态PC005 1T PCIE 3.0 x4 旗舰款固态

顺序写入速度：2900MB/s （算上了模拟SLC缓存）

当SLC缓存被装满，依赖主控和闪存颗粒自身的能力，速度掉到750MB/s

#### 5. 4K随机读写

顺序读写和4K随机读写的差别（大文件或大压缩包 vs 小文件，碎片化）

IOPS 即每秒进行读写操作的次数，数字越大，4K性能越强。

① 随机读写性能，固态都碾压机械硬盘。

② 只要是固态，无论是走SATA还是PCIE通道，它的4K 随机读写差异不大。

注：购买固态，容量为先，速度为次。

机械硬盘 VS 固态硬盘

① 机械结构，随机读写受制于寻道时间，虽然转速达5400 或 7200转，但是还是慢。

② 固态硬盘，跑分时需要注意，有时候测试的文件大小的缘故，实际跑的是缓存的读写速率，而非颗粒。

#### 6. TBW数据写入量

即硬盘能写多少T的数据

### 小结

1. 购买固态硬盘建议首选原厂原封品牌
2. 购买固态，容量为先，速度其次。建议首先选择M.2接口，支持PCIE3.0x4的普通款固态硬盘，性价比高。
3. 目前TLC是主流选择，不要碰QLC颗粒的固态硬盘，没必要碰。
4. 硬盘保修很重要，建议选择TBW高一些的，支持个人送保的品牌。

